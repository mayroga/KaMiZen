<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>KaMiZen - Sesi√≥n diaria</title>
<link rel="stylesheet" href="/static/style.css">
<style>
body { background:#111; color:#eee; font-family: Arial, sans-serif; }
#sessionContainer { max-width:800px; margin:auto; padding:20px; }
#participants,#timeRemaining,#feedback,#ranking { margin-bottom:10px; }
#questionBox { background:#222; padding:15px; border-radius:8px; margin-bottom:10px; font-size:1.2em; }
#answerInput,#chatInput { width:100%; padding:10px; margin-bottom:5px; border-radius:5px; border:none; }
#chatBox { background:#222; padding:10px; height:200px; overflow-y:auto; border-radius:8px; margin-bottom:10px; }
button { padding:10px 20px; border:none; border-radius:5px; background:#ff4d4d; color:#fff; font-weight:bold; cursor:pointer; margin:3px; }
button:hover { background:#ff1a1a; }
.timer { font-size:1.2em; font-weight:bold; }
.chatMessage { margin-bottom:4px; }
.simulated { color:#ffcc00; font-weight:bold; }
#rankingList { margin-top:5px; }
.level { font-weight:bold; color:#00ffcc; }
#miniGameBox {
    background:#1a1a1a;
    padding:15px;
    border-radius:8px;
    margin-top:15px;
}
.answerOption {
    display:block;
    width:100%;
    margin-top:5px;
    background:#333;
}
.answerOption:hover {
    background:#444;
}
.correct {
    background:#00aa55 !important;
}
.wrong {
    background:#aa0000 !important;
}
</style>
</head>

<body>
<div id="sessionContainer">

    <h1>KaMiZen - Sesi√≥n diaria</h1>

    <div id="participants">üî• Conectados: 1/500</div>

    <div class="timer">
        ‚è≥ Tiempo restante: <span id="timeRemaining">10:00</span>
    </div>

    <div id="ranking">
        üèÜ Top 5 del momento
        <div id="rankingList"></div>
    </div>

    <div id="questionBox">
        Bienvenido a KaMiZen. Prep√°rate para activar tu mente.
    </div>

    <input type="text" id="answerInput" placeholder="Escribe tu respuesta aqu√≠...">
    <button onclick="sendAnswer()">Enviar</button>

    <div id="feedback"></div>

    <h3>Chat en vivo (an√≥nimo)</h3>
    <div id="chatBox">Cargando chat...</div>

    <input type="text" id="chatInput" placeholder="Escribe mensaje...">
    <button onclick="sendChat()">Enviar</button>

    <!-- MINI JUEGOS -->
    <div id="miniGameBox">
        <h3>üß† Mini Juego Mental</h3>
        <div id="miniGameQuestion">Presiona iniciar para activar el reto.</div>
        <div id="miniGameOptions"></div>
        <button onclick="generateMiniGame()">Activar Reto Mental</button>
    </div>

    <audio id="sessionAudio" autoplay></audio>

</div>

<script>

// ------------------------------
// MINI JUEGOS DIN√ÅMICOS
// ------------------------------

function generateMiniGame() {

    const questionBox = document.getElementById("miniGameQuestion");
    const optionsBox = document.getElementById("miniGameOptions");
    optionsBox.innerHTML = "";

    const gameType = Math.floor(Math.random() * 6);

    let question = "";
    let correctAnswer = "";
    let options = [];

    // 1Ô∏è‚É£ Matem√°tica emocional
    if (gameType === 0) {
        const base = Math.floor(Math.random() * 5) + 1;
        const plus = Math.floor(Math.random() * 6) + 2;
        correctAnswer = base + plus;
        question = `Si hoy me siento ${base} puntos feliz y ma√±ana ${plus} puntos m√°s‚Ä¶ ¬øcu√°nto tendr√©?`;
        options = [correctAnswer, correctAnswer+1, correctAnswer-1];
    }

    // 2Ô∏è‚É£ Problemas vs oportunidades
    else if (gameType === 1) {
        correctAnswer = "6 oportunidades";
        question = "Si tengo 10 problemas y resuelvo 4, ¬øqu√© me queda?";
        options = ["6 problemas", "6 oportunidades", "4 problemas"];
    }

    // 3Ô∏è‚É£ N√∫mero escondido
    else if (gameType === 2) {
        correctAnswer = 14;
        question = "Soy un n√∫mero mayor que 10 y menor que 20. Soy par. Si me divides entre 2, te da 7. ¬øQui√©n soy?";
        options = [12, 14, 16];
    }

    // 4Ô∏è‚É£ Series divertidas
    else if (gameType === 3) {
        correctAnswer = 8;
        question = "Completa la serie: 2, 4, 6, __";
        options = [7, 8, 10];
    }

    // 5Ô∏è‚É£ Dobles f√°ciles
    else if (gameType === 4) {
        correctAnswer = 24;
        question = "¬øCu√°nto es el doble de 12?";
        options = [22, 24, 26];
    }

    // 6Ô∏è‚É£ Adivinanza log√≠stica
    else {
        correctAnswer = "Conocimiento de embarque";
        question = "Vuelo sin alas, cruzo fronteras sin pasaporte y guardo tesoros sin ser cofre. ¬øQu√© soy?";
        options = ["Avi√≥n", "Maleta", "Conocimiento de embarque"];
    }

    questionBox.innerText = question;

    options.sort(() => Math.random() - 0.5);

    options.forEach(option => {
        const btn = document.createElement("button");
        btn.className = "answerOption";
        btn.innerText = option;
        btn.onclick = function() {
            if (option == correctAnswer) {
                btn.classList.add("correct");
                document.getElementById("feedback").innerText = "üí• Correcto! Dopamina activada!";
                speak("Correcto. Tu mente est√° activa.");
            } else {
                btn.classList.add("wrong");
                document.getElementById("feedback").innerText = "‚ö†Ô∏è Intenta nuevamente. Tu mente puede m√°s.";
                speak("Intenta otra vez.");
            }
        };
        optionsBox.appendChild(btn);
    });

    speak(question);
}

// ------------------------------
// VOZ AUTOM√ÅTICA LOCAL
// ------------------------------

function speak(text) {
    const msg = new SpeechSynthesisUtterance(text);
    msg.lang = "es-ES";
    msg.rate = 1;
    msg.pitch = 1;
    window.speechSynthesis.speak(msg);
}

// ------------------------------
// FUNCIONES EXISTENTES
// ------------------------------

function sendAnswer() {
    const input = document.getElementById("answerInput");
    if(input.value.trim() === "") return;
    document.getElementById("feedback").innerText = "üí• Respuesta enviada.";
    input.value = "";
}

function sendChat() {
    const input = document.getElementById("chatInput");
    if(input.value.trim() === "") return;

    const chatBox = document.getElementById("chatBox");
    const msg = document.createElement("div");
    msg.className = "chatMessage";
    msg.innerText = input.value;
    chatBox.appendChild(msg);

    input.value = "";
    chatBox.scrollTop = chatBox.scrollHeight;
}

</script>

</body>
</html>
