<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>KaMiZen – Sistema Integral de Bienestar</title>
<link rel="stylesheet" href="/static/style.css">
<script src="https://js.stripe.com/v3/"></script>
</head>
<body>

<div id="loader">KaMiZen sintonizando tu momento…</div>

<div id="app" style="display:none">
<header>
  <select id="lang" onchange="setLang(this.value)">
    <option value="es">ES</option>
    <option value="en">English</option>
    <option value="fr">Français</option>
    <option value="de">Deutsch</option>
    <option value="zh">中文</option>
  </select>
</header>

<section class="landscape">
  <pre>{{ ai_landscape }}</pre>
</section>

<section id="nivel1">
  <h2>Nivel 1 – CSi Perfecto</h2>
  <p>Microacciones, respiración, mindfulness breve, hidratación, estiramientos, pausas, exposición a luz solar.</p>
  <button onclick="recordMicroaction('respiración consciente')">Respiración consciente</button>
  <button onclick="recordMicroaction('mini estiramiento')">Mini estiramiento</button>
</section>

<section id="nivel2">
  <h2>Nivel 2 – PRO</h2>
  <p>Experiencia profunda, dualidad emocional, audio ambiental, paisajes únicos, risoterapia adaptativa.</p>
  <button onclick="goPro()">Entrar PRO – $99</button>
</section>
</div>

<script>
setTimeout(()=>{
 document.getElementById("loader").style.display="none";
 document.getElementById("app").style.display="block";
},1200)

const stripe = Stripe("{{ stripe_key }}");

function goPro(){
 fetch("/create-checkout-session",{method:"POST"})
 .then(r=>r.json())
 .then(d=>stripe.redirectToCheckout({sessionId:d.id}))
}

function recordMicroaction(action){
 fetch("/microaction",{
  method:"POST",
  body: new URLSearchParams({user_id: location.hostname, action: action})
}).then(r=>r.json()).then(console.log)
}

function setLang(l){
 document.documentElement.lang = l;
}
</script>
<script src="/static/app.js"></script>
</body>
</html>
