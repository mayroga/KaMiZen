<!DOCTYPE html>
<html>
<head>
    <style>
        .game-container {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%); width: 80%;
            background: white; padding: 40px; border-radius: 30px;
            box-shadow: 0 25px 60px rgba(0,0,0,0.2); text-align: center;
            z-index: 4000; font-family: sans-serif;
        }
        .challenge-text { font-size: 1.6rem; color: #2c3e50; margin-bottom: 30px; }
        .btn-reveal {
            background: #2c3e50; color: white; border: none;
            padding: 15px 40px; border-radius: 30px; cursor: pointer; font-size: 1.1rem;
        }
        .answer-box {
            margin-top: 25px; padding: 20px; background: #f8f9fa;
            border-radius: 15px; display: none; animation: fadeIn 1s;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div id="challenge" class="challenge-text">Preparando tu reto mental...</div>
        <button id="reveal-btn" class="btn-reveal" onclick="revelar()">Ver soluci√≥n</button>
        <div id="answer-box" class="answer-box">
            <p id="correct-answer" style="font-weight:bold;"></p>
            <p id="explanation"></p>
        </div>
    </div>
    <audio id="audio-game" style="display:none;"></audio>

    <script>
        let explicacionVoz = "";

        async function cargarReto() {
            const lang = localStorage.getItem('kmz_lang') || 'en';
            const res = await fetch(`/api/get_mental_challenge?lang=${lang}`);
            const data = await res.json();
            
            document.getElementById('challenge').innerText = data.pregunta;
            document.getElementById('correct-answer').innerText = data.respuesta;
            document.getElementById('explanation').innerText = data.explicacion;
            explicacionVoz = data.explicacion;
        }

        function revelar() {
            document.getElementById('answer-box').style.display = 'block';
            document.getElementById('reveal-btn').style.display = 'none';
            
            const audio = document.getElementById('audio-game');
            audio.src = `/api/get_audio?text=${encodeURIComponent(explicacionVoz)}`;
            audio.play();
        }

        window.onload = cargarReto;
    </script>
</body>
</html>
